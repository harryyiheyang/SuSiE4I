% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SuSiE4I.R
\name{SuSiE4I}
\alias{SuSiE4I}
\title{SuSiE4I: Iterative SuSiE fitting for main and interaction effects (dense matrix only)}
\usage{
SuSiE4I(
  X,
  Z = NULL,
  y,
  crossprodX = NULL,
  n_threads = 4,
  L_main = 10,
  L_int = 5,
  select_env = F,
  L_env = 10,
  noint_env = NULL,
  coverage_main = 0.95,
  coverage_int = 0.85,
  coverage_env = 0.95,
  max_iter = 15,
  max_eps = 1e-05,
  min_iter = 3,
  susie_iter = 300,
  verbose = TRUE,
  returnModel = F,
  ...
)
}
\arguments{
\item{X}{An n × p matrix of covariates.}

\item{Z}{An n × q matrix of covariates. If Z = NULL, only GxG interaction will be consider.}

\item{y}{An n-vector of responses.}

\item{crossprodX}{The cross-product of X (default = F, and SuSiE4X will calculate it).}

\item{n_threads}{Integer. Number of threads used in parallel computations, such as blockwise matrix cross-product or matrix–vector multiplication. Default is 1 (no parallelism). Increasing this can speed up computation on multicore machines when \code{is.large = TRUE}.}

\item{L_main}{The number of SuSiE effects for main effect X (default = 10).}

\item{L_int}{The number of SuSiE effects for interactions (default = 5).}

\item{select_env}{A indicator of whether selecting the environmental factors (default = F).}

\item{L_env}{If select_env = T, the number of SuSiE effects for interactions (default = 10).}

\item{noint_env}{The indices of environmental factors that would not be included in GEI search (default = NULL). When select_env = T, this parameter will not be considered.}

\item{coverage_main}{The coverage to defining a credible set in fine-mapping main effects (default to 0.95).}

\item{coverage_int}{The coverage to defining a credible set in fine-mapping interaction effects (default to 0.85).}

\item{coverage_env}{If select_env = T,the coverage to defining a credible set in fine-mapping environmental effects (default to 0.95).}

\item{max_iter}{Maximum number of outer iterations (default = 10).}

\item{max_eps}{Convergence threshold on η (default = 1e-5).}

\item{min_iter}{Minimum number of outer iterations (default = 3).}

\item{susie_iter}{Maximum number of iterations for each SuSiE fit (default = 300).}

\item{verbose}{A logical indicator of whether to display iteration diagnostics (default = TRUE).}

\item{returnModel}{A logical indicator of whether to return the final model design matrix (default = False).}

\item{...}{Additional arguments passed to \code{susie_suff_stat}, such as \code{prior_variance}, \code{null_weight}, \code{standardize}, etc. Note that these tuning parameters will only be used in the fine-mapping of marginal effects.}
}
\value{
A list containing results from the iterative SuSiE fitting procedure:
\describe{
  \item{iter}{Total number of outer iterations completed before convergence or reaching maximum.}
  \item{error}{Numeric vector of max change in fitted values across iterations.}
  \item{fitX}{SuSiE result for main effects.}
  \item{fitW}{SuSiE result for interaction terms.}
  \item{fitZ}{Final linear model of y ~ Z with offset.}
  \item{fitJoint}{Final linear model of y ~ Z + credible sets of direct and interaction effects.}
}
}
\description{
This function performs iterative estimation of additive (Z) and main (X) effects, as well as
interaction effects between selected X components and Z, using SuSiE on sufficient statistics.
}
\details{
For large sample size, it uses a blockwise strategy to compute `crossprod(X)` efficiently
without requiring the full X'X in memory at once.

The algorithm alternates between updating the effects from Z (via linear projection),
from X (via susie_suff_stat), and interaction terms (via susie_suff_stat after constructing selected interactions).
After convergence, a post-hoc linear model of y ~ Z is fit with offset(etaX + etaW) to estimate
the significance of Z effects adjusted for X and interactions.
}
